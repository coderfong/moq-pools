# Product Detail Drawer

A beautiful, responsive side drawer that displays detailed product information for listings.

## Features

- âœ¨ **Beautiful Design**: Modern, gradient-enhanced UI with smooth animations
- ðŸ“± **Responsive**: Full-width on mobile, fixed width on desktop
- ðŸŽ¨ **Dynamic Data**: Displays real product data from the database
- âš¡ **Performance**: Includes caching and prefetching support
- ðŸ”’ **Type-Safe**: Full TypeScript support

## Components

### DetailPanelHost

The main drawer component that handles display and data fetching.

Located at: `src/components/DetailPanelHost.tsx`

### DetailLink

A helper component to trigger the drawer from anywhere in the app.

Located at: `src/components/DetailLink.tsx`

## Usage

### Basic Usage with DetailLink

```tsx
import DetailLink from '@/components/DetailLink';

function ProductCard({ product }) {
  return (
    <div>
      <h3>{product.title}</h3>
      <DetailLink 
        url={product.url} 
        title={product.title}
        productData={product}
      >
        View Details
      </DetailLink>
    </div>
  );
}
```

### Programmatic Usage

```tsx
import { openProductDrawer } from '@/components/DetailLink';

function MyComponent() {
  const handleClick = () => {
    openProductDrawer(
      'https://example.com/product',
      'Product Title',
      {
        title: 'Product Title',
        price: '$99.99',
        moq: 100,
        // ... more product data
      }
    );
  };

  return <button onClick={handleClick}>Open Drawer</button>;
}
```

### Using Custom Events

```tsx
function triggerDrawer() {
  const evt = new CustomEvent('open-detail-panel', {
    detail: {
      url: 'https://example.com/product',
      title: 'Product Title',
      productData: {
        // Product data object
      }
    }
  });
  window.dispatchEvent(evt);
}
```

## Product Data Structure

```typescript
type ProductData = {
  title?: string;
  platform?: string;           // e.g., 'ALIBABA', 'MADE_IN_CHINA'
  price?: string;
  priceMin?: number;
  priceMax?: number;
  currency?: string;           // e.g., 'USD', 'CNY'
  moq?: number;                // Minimum Order Quantity
  moqRaw?: string;
  storeName?: string;
  description?: string;
  priceTiers?: PriceTier[];    // Array of pricing tiers
  detailJson?: any;            // Additional structured data
  image?: string;
  ordersRaw?: string;
  ratingRaw?: string;
};

type PriceTier = {
  min: number;
  max?: number;
  price: number;
  originalPrice?: number;
};
```

## API Endpoint

The drawer fetches product data from:

```
GET /api/products/by-url?url={productUrl}
```

**Response:**
```json
{
  "product": {
    "id": "...",
    "platform": "ALIBABA",
    "url": "...",
    "title": "...",
    "priceMin": 99.99,
    "currency": "USD",
    // ... more fields
  }
}
```

## Sections Displayed

1. **Product Image** - If available
2. **Pricing Tiers** - Shows all price tiers with discounts
3. **Pool Status** - Current pool progress and MOQ
4. **Product Details** - MOQ, lead time, variants, certifications, etc.
5. **Shipping Information** - Methods, delivery times, etc.
6. **Seller Information** - Store name, rating, years active
7. **Description** - Product description
8. **Important Notes** - Warnings and disclaimers

## Styling

The drawer uses:
- **TailwindCSS** for utility classes
- **Gradient backgrounds** for visual appeal
- **Smooth transitions** for opening/closing
- **Custom scrollbar** styling (`.drawer-scroll` class)
- **Responsive design** - full-width on mobile, 48rem on desktop

## Keyboard Support

- **ESC** - Close the drawer
- **Click outside** - Close the drawer

## Caching

The component includes built-in caching:
- Product data is cached in memory per URL
- Prefetching on hover/focus
- Reduces API calls for frequently viewed products

## Example Integration

In your product listing page:

```tsx
import DetailLink from '@/components/DetailLink';

export default function ProductsPage() {
  const products = [...]; // Your products array

  return (
    <div className="grid gap-4">
      {products.map(product => (
        <div key={product.id} className="border rounded-lg p-4">
          <h3>{product.title}</h3>
          <p>{product.description}</p>
          
          <DetailLink
            url={product.url}
            title={product.title}
            productData={product}
            className="mt-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"
          >
            View Full Details
          </DetailLink>
        </div>
      ))}
    </div>
  );
}
```

## Notes

- The drawer must be included in your main layout (already included in the root layout)
- Product data can be passed directly or will be fetched from the API
- All product URLs should be from saved listings in the database
- The drawer works with multiple source platforms (Alibaba, Made in China, IndiaMART, etc.)
